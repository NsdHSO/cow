import { animate, state, style, transition, trigger } from '@angular/animations';
import { moveItemInArray } from "@angular/cdk/drag-drop";
import { Breakpoints } from '@angular/cdk/layout';
import { Component, ContentChildren, EventEmitter, Input, Output, ViewChild, ViewEncapsulation } from '@angular/core';
import { MatPaginator } from '@angular/material/paginator';
import { MatTable } from '@angular/material/table';
import { Subject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
import { BaseColumn } from '../base-column';
import * as i0 from "@angular/core";
import * as i1 from "@angular/cdk/layout";
import * as i2 from "@angular/common";
import * as i3 from "@angular/material/icon";
import * as i4 from "@angular/material/table";
import * as i5 from "@angular/material/paginator";
import * as i6 from "@angular/cdk/drag-drop";
export class TableComponent {
    constructor(_changeDetectorRef, _brPoint) {
        this._changeDetectorRef = _changeDetectorRef;
        this._brPoint = _brPoint;
        this.extensible = false;
        // Footer
        this.footerShow = false;
        // class for footer
        this.footerMessageClass = '';
        // flag about if we want to show pagination
        this.showPagination = false;
        this.addedNewEntry = false;
        this.onAddEntry = new EventEmitter();
        this.onPaginationChange = new EventEmitter();
        this.columnsToDispaly = [];
        this.doubleColumnToDisplay = [];
        // for avoid memory leak
        this._destroyed = new Subject();
    }
    // after the <ng-content> has been initialized, the column definitions are available.
    ngAfterViewInit() {
        this.columnsToDispaly = this.columnDefs.map((resp) => resp.columnDef.name);
        this.columnDefs
            .map((resp) => resp.columnDef)
            .forEach((rep) => this.table.addColumnDef(rep));
        try {
            const duplicate = this.columnsToDispaly.filter((columnDisplay, index, self) => index === self.findIndex((value) => value === columnDisplay));
            this.doubleColumnToDisplay = this.columnsToDispaly;
            this._setColumnForLayout();
            if (duplicate.length < this.columnsToDispaly.length) {
                throw new Error('You duplicate value what you want to display, Please look in definitions at columns');
            }
        }
        catch (err) {
            console.error(err);
        }
        this._changeDetectorRef.detectChanges();
    }
    addNewEntry() {
        this.onAddEntry.next();
    }
    changePage(event) {
        this.onPaginationChange.emit(event);
    }
    drop(event) {
        moveItemInArray(this.dataSource, event.previousIndex, event.currentIndex);
        this.table.renderRows();
    }
    ngOnDestroy() {
        this._destroyed.next();
        this._destroyed.complete();
    }
    _setColumnForLayout() {
        this._brPoint
            .observe([
            Breakpoints.XSmall,
            Breakpoints.Small,
            Breakpoints.Medium,
            Breakpoints.Large,
            Breakpoints.XLarge,
        ])
            .pipe(takeUntil(this._destroyed))
            .subscribe(() => {
            if (this._brPoint.isMatched(Breakpoints.XSmall)) {
                this.columnsToDispaly = this.doubleColumnToDisplay.filter((item, index) => {
                    return (index <= 0 || index === this.doubleColumnToDisplay.length - 1);
                });
            }
            else if (this._brPoint.isMatched(Breakpoints.Small)) {
                this.columnsToDispaly = this.doubleColumnToDisplay.filter((item, index) => {
                    return (index <= 2 || index === this.doubleColumnToDisplay.length - 1);
                });
            }
            else if (this._brPoint.isMatched(Breakpoints.Medium)) {
                this.columnsToDispaly = this.doubleColumnToDisplay.filter((item, index) => {
                    return (index <= 3 || index === this.doubleColumnToDisplay.length - 1);
                });
            }
            else if (this._brPoint.isMatched(Breakpoints.Large)) {
                this.columnsToDispaly = this.doubleColumnToDisplay.filter((item, index) => {
                    return (index <= 4 || index === this.doubleColumnToDisplay.length - 1);
                });
            }
            else if (this._brPoint.isMatched(Breakpoints.XLarge)) {
                this.columnsToDispaly = this.doubleColumnToDisplay.filter((item, index) => {
                    return (index >= 0);
                });
            }
        });
    }
}
TableComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.2", ngImport: i0, type: TableComponent, deps: [{ token: i0.ChangeDetectorRef }, { token: i1.BreakpointObserver }], target: i0.ɵɵFactoryTarget.Component });
TableComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.2.2", type: TableComponent, selector: "elix-table", inputs: { dataSource: "dataSource", extensible: "extensible", extandble$: "extandble$", footerShow: "footerShow", footerMessageClass: "footerMessageClass", newElementExtandble: "newElementExtandble", showPagination: "showPagination", lenghtPagination: "lenghtPagination", paginationClass: "paginationClass", addedNewEntry: "addedNewEntry" }, outputs: { onAddEntry: "onAddEntry", onPaginationChange: "onPaginationChange" }, queries: [{ propertyName: "columnDefs", predicate: BaseColumn }], viewQueries: [{ propertyName: "table", first: true, predicate: MatTable, descendants: true, static: true }, { propertyName: "paginator", first: true, predicate: MatPaginator, descendants: true }], ngImport: i0, template: "<mat-table mat-table [dataSource]=\"dataSource\" multiTemplateDataRows=\"true\" cdkDropList [cdkDropListData]=\"dataSource\"\n           [ngStyle]=\"{'box-shadow': addedNewEntry ? 'none': ''}\"\n           (cdkDropListDropped)=\"drop($event)\">\n  <ng-content></ng-content>\n  <mat-header-row\n    class=\"header-color gap-1\"\n    mat-header-row\n    *matHeaderRowDef=\"columnsToDispaly; sticky: true\"\n  >\n  </mat-header-row>\n  <mat-row\n    mat-row\n    cdkDrag\n    *matRowDef=\"let row; columns: columnsToDispaly\"\n    class=\"gap-1 header-border-left\"\n  ></mat-row>\n  <!-- Footer for tabel -->\n  <ng-container *ngIf=\"footerShow\">\n    <mat-footer-row\n      [class]=\"footerMessageClass\"\n      *matFooterRowDef=\"columnsToDispaly\"\n      [attr.colspan]=\"columnsToDispaly.length\"\n    >\n    </mat-footer-row>\n  </ng-container>\n\n  <!--  Extanble-->\n  <ng-container *ngIf=\"extensible\">\n    <ng-container matColumnDef=\"extensibleData\">\n      <mat-cell\n        *matCellDef=\"let element\"\n        [attr.colspan]=\"columnsToDispaly.length\"\n        class=\"overflow-hidden\"\n      >\n        <div\n          [@detailExpand]=\"\n            element === (extandble$ | async) ? 'expanded' : 'collapsed'\n          \"\n          class=\"elix__table\"\n        >\n          <ng-container\n            *ngTemplateOutlet=\"\n              newElementExtandble;\n              context: { $implicit: element }\n            \"\n          >\n          </ng-container>\n        </div>\n      </mat-cell>\n    </ng-container>\n\n    <mat-row\n      *matRowDef=\"let row; columns: ['extensibleData']\"\n      class=\"example-detail-row gap-1 header-border-left\"\n    ></mat-row>\n  </ng-container>\n</mat-table>\n<div class=\"new\" *ngIf=\"addedNewEntry\" (click)=\"addNewEntry()\">\n  <mat-icon\n    [svgIcon]=\"'fa_solid:circle-plus'\"\n    class=\"new-entry\"\n  ></mat-icon>\n  <div>\n    <p>Added new Entry</p>\n  </div>\n\n</div>\n<mat-paginator\n  [class]=\"paginationClass\"\n  *ngIf=\"showPagination\"\n  (page)=\"changePage($event)\"\n  [length]=\"lenghtPagination\"\n  [pageSizeOptions]=\"[10, 20, 50]\"\n  showFirstLastButtons\n  aria-label=\"Select page of periodic elements\"\n>\n</mat-paginator>\n", styles: ["elix-table{transition:all .5s ease-in}elix-table mat-table{color:transparent;border-collapse:collapse;border-radius:.5rem;overflow:hidden;box-shadow:#00000026 0 15px 25px,#0000000d 0 5px 10px}elix-table .header-border-left{border-left:1px solid}elix-table mat-header-row mat-header-cell{justify-content:flex-start;border-spacing:2rem}elix-table mat-row{box-shadow:#0366d64d 0 0 0 3px;transition:all ease-in-out .1s;min-height:32px;border:.2px solid;position:relative;height:39px}elix-table mat-row textarea{outline:none}elix-table mat-row:hover{background:rgba(1,1,222,.1)}elix-table mat-row mat-cell{justify-content:flex-start;position:relative;min-height:1rem;color:#000}elix-table mat-row mat-cell mat-form-field div{padding:0!important;border:0!important}elix-table mat-row mat-cell mat-form-field div input{border:1px solid;box-shadow:inset 0 0 3px 1px #00f3}elix-table mat-row mat-cell textarea{background:inherit;height:1.95rem}elix-table mat-row mat-cell textarea:focus-visible{outline:none;border:1px solid var(--primary-color-input)}elix-table mat-row mat-cell button{padding:0!important;min-width:auto!important}elix-table mat-header-row{min-height:1.5rem}elix-table mat-header-row mat-header-cell{min-height:inherit}elix-table mat-header-cell{color:#fff!important}elix-table .header-color{background:#2d333b;z-index:99!important}elix-table .mat-form-field-infix{width:auto}elix-table .example-detail-row{min-height:0!important}elix-table .example-detail-row mat-cell{min-height:inherit}elix-table .example-detail-row mat-cell .mat-form-field-infix{width:auto!important}.cdk-drop-list-dragging .cdk-drag{transition:transform .35s cubic-bezier(0,0,.2,1)}.cdk-drag-preview{z-index:200;background-color:#fff;border:1px solid #5f7651;box-shadow:#32325d40 0 6px 12px -2px,#0000004d 0 3px 7px -3px}.cdk-drag-animating{transition:transform .35s cubic-bezier(0,0,.2,1)}.new{display:flex;align-items:center;padding:1rem 0 1rem .5rem}.new-entry{color:#52796f!important;padding-right:.5rem}\n"], dependencies: [{ kind: "directive", type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i2.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "directive", type: i2.NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }, { kind: "component", type: i3.MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }, { kind: "component", type: i4.MatTable, selector: "mat-table, table[mat-table]", exportAs: ["matTable"] }, { kind: "directive", type: i4.MatHeaderRowDef, selector: "[matHeaderRowDef]", inputs: ["matHeaderRowDef", "matHeaderRowDefSticky"] }, { kind: "directive", type: i4.MatColumnDef, selector: "[matColumnDef]", inputs: ["sticky", "matColumnDef"] }, { kind: "directive", type: i4.MatCellDef, selector: "[matCellDef]" }, { kind: "directive", type: i4.MatRowDef, selector: "[matRowDef]", inputs: ["matRowDefColumns", "matRowDefWhen"] }, { kind: "directive", type: i4.MatFooterRowDef, selector: "[matFooterRowDef]", inputs: ["matFooterRowDef", "matFooterRowDefSticky"] }, { kind: "directive", type: i4.MatCell, selector: "mat-cell, td[mat-cell]" }, { kind: "component", type: i4.MatHeaderRow, selector: "mat-header-row, tr[mat-header-row]", exportAs: ["matHeaderRow"] }, { kind: "component", type: i4.MatRow, selector: "mat-row, tr[mat-row]", exportAs: ["matRow"] }, { kind: "component", type: i4.MatFooterRow, selector: "mat-footer-row, tr[mat-footer-row]", exportAs: ["matFooterRow"] }, { kind: "component", type: i5.MatPaginator, selector: "mat-paginator", inputs: ["disabled"], exportAs: ["matPaginator"] }, { kind: "directive", type: i6.CdkDropList, selector: "[cdkDropList], cdk-drop-list", inputs: ["cdkDropListConnectedTo", "cdkDropListData", "cdkDropListOrientation", "id", "cdkDropListLockAxis", "cdkDropListDisabled", "cdkDropListSortingDisabled", "cdkDropListEnterPredicate", "cdkDropListSortPredicate", "cdkDropListAutoScrollDisabled", "cdkDropListAutoScrollStep"], outputs: ["cdkDropListDropped", "cdkDropListEntered", "cdkDropListExited", "cdkDropListSorted"], exportAs: ["cdkDropList"] }, { kind: "directive", type: i6.CdkDrag, selector: "[cdkDrag]", inputs: ["cdkDragData", "cdkDragLockAxis", "cdkDragRootElement", "cdkDragBoundary", "cdkDragStartDelay", "cdkDragFreeDragPosition", "cdkDragDisabled", "cdkDragConstrainPosition", "cdkDragPreviewClass", "cdkDragPreviewContainer"], outputs: ["cdkDragStarted", "cdkDragReleased", "cdkDragEnded", "cdkDragEntered", "cdkDragExited", "cdkDragDropped", "cdkDragMoved"], exportAs: ["cdkDrag"] }, { kind: "pipe", type: i2.AsyncPipe, name: "async" }], animations: [
        trigger('detailExpand', [
            state('collapsed', style({ height: '0px', minHeight: '0' })),
            state('expanded', style({ height: '*' })),
            transition('expanded <=> collapsed', animate('225ms cubic-bezier(0.4, 0.0, 0.2, 1)')),
        ]),
    ], encapsulation: i0.ViewEncapsulation.None });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.2", ngImport: i0, type: TableComponent, decorators: [{
            type: Component,
            args: [{ selector: 'elix-table', animations: [
                        trigger('detailExpand', [
                            state('collapsed', style({ height: '0px', minHeight: '0' })),
                            state('expanded', style({ height: '*' })),
                            transition('expanded <=> collapsed', animate('225ms cubic-bezier(0.4, 0.0, 0.2, 1)')),
                        ]),
                    ], encapsulation: ViewEncapsulation.None, template: "<mat-table mat-table [dataSource]=\"dataSource\" multiTemplateDataRows=\"true\" cdkDropList [cdkDropListData]=\"dataSource\"\n           [ngStyle]=\"{'box-shadow': addedNewEntry ? 'none': ''}\"\n           (cdkDropListDropped)=\"drop($event)\">\n  <ng-content></ng-content>\n  <mat-header-row\n    class=\"header-color gap-1\"\n    mat-header-row\n    *matHeaderRowDef=\"columnsToDispaly; sticky: true\"\n  >\n  </mat-header-row>\n  <mat-row\n    mat-row\n    cdkDrag\n    *matRowDef=\"let row; columns: columnsToDispaly\"\n    class=\"gap-1 header-border-left\"\n  ></mat-row>\n  <!-- Footer for tabel -->\n  <ng-container *ngIf=\"footerShow\">\n    <mat-footer-row\n      [class]=\"footerMessageClass\"\n      *matFooterRowDef=\"columnsToDispaly\"\n      [attr.colspan]=\"columnsToDispaly.length\"\n    >\n    </mat-footer-row>\n  </ng-container>\n\n  <!--  Extanble-->\n  <ng-container *ngIf=\"extensible\">\n    <ng-container matColumnDef=\"extensibleData\">\n      <mat-cell\n        *matCellDef=\"let element\"\n        [attr.colspan]=\"columnsToDispaly.length\"\n        class=\"overflow-hidden\"\n      >\n        <div\n          [@detailExpand]=\"\n            element === (extandble$ | async) ? 'expanded' : 'collapsed'\n          \"\n          class=\"elix__table\"\n        >\n          <ng-container\n            *ngTemplateOutlet=\"\n              newElementExtandble;\n              context: { $implicit: element }\n            \"\n          >\n          </ng-container>\n        </div>\n      </mat-cell>\n    </ng-container>\n\n    <mat-row\n      *matRowDef=\"let row; columns: ['extensibleData']\"\n      class=\"example-detail-row gap-1 header-border-left\"\n    ></mat-row>\n  </ng-container>\n</mat-table>\n<div class=\"new\" *ngIf=\"addedNewEntry\" (click)=\"addNewEntry()\">\n  <mat-icon\n    [svgIcon]=\"'fa_solid:circle-plus'\"\n    class=\"new-entry\"\n  ></mat-icon>\n  <div>\n    <p>Added new Entry</p>\n  </div>\n\n</div>\n<mat-paginator\n  [class]=\"paginationClass\"\n  *ngIf=\"showPagination\"\n  (page)=\"changePage($event)\"\n  [length]=\"lenghtPagination\"\n  [pageSizeOptions]=\"[10, 20, 50]\"\n  showFirstLastButtons\n  aria-label=\"Select page of periodic elements\"\n>\n</mat-paginator>\n", styles: ["elix-table{transition:all .5s ease-in}elix-table mat-table{color:transparent;border-collapse:collapse;border-radius:.5rem;overflow:hidden;box-shadow:#00000026 0 15px 25px,#0000000d 0 5px 10px}elix-table .header-border-left{border-left:1px solid}elix-table mat-header-row mat-header-cell{justify-content:flex-start;border-spacing:2rem}elix-table mat-row{box-shadow:#0366d64d 0 0 0 3px;transition:all ease-in-out .1s;min-height:32px;border:.2px solid;position:relative;height:39px}elix-table mat-row textarea{outline:none}elix-table mat-row:hover{background:rgba(1,1,222,.1)}elix-table mat-row mat-cell{justify-content:flex-start;position:relative;min-height:1rem;color:#000}elix-table mat-row mat-cell mat-form-field div{padding:0!important;border:0!important}elix-table mat-row mat-cell mat-form-field div input{border:1px solid;box-shadow:inset 0 0 3px 1px #00f3}elix-table mat-row mat-cell textarea{background:inherit;height:1.95rem}elix-table mat-row mat-cell textarea:focus-visible{outline:none;border:1px solid var(--primary-color-input)}elix-table mat-row mat-cell button{padding:0!important;min-width:auto!important}elix-table mat-header-row{min-height:1.5rem}elix-table mat-header-row mat-header-cell{min-height:inherit}elix-table mat-header-cell{color:#fff!important}elix-table .header-color{background:#2d333b;z-index:99!important}elix-table .mat-form-field-infix{width:auto}elix-table .example-detail-row{min-height:0!important}elix-table .example-detail-row mat-cell{min-height:inherit}elix-table .example-detail-row mat-cell .mat-form-field-infix{width:auto!important}.cdk-drop-list-dragging .cdk-drag{transition:transform .35s cubic-bezier(0,0,.2,1)}.cdk-drag-preview{z-index:200;background-color:#fff;border:1px solid #5f7651;box-shadow:#32325d40 0 6px 12px -2px,#0000004d 0 3px 7px -3px}.cdk-drag-animating{transition:transform .35s cubic-bezier(0,0,.2,1)}.new{display:flex;align-items:center;padding:1rem 0 1rem .5rem}.new-entry{color:#52796f!important;padding-right:.5rem}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }, { type: i1.BreakpointObserver }]; }, propDecorators: { dataSource: [{
                type: Input
            }], extensible: [{
                type: Input
            }], extandble$: [{
                type: Input
            }], footerShow: [{
                type: Input
            }], footerMessageClass: [{
                type: Input
            }], newElementExtandble: [{
                type: Input
            }], showPagination: [{
                type: Input
            }], lenghtPagination: [{
                type: Input
            }], paginationClass: [{
                type: Input
            }], addedNewEntry: [{
                type: Input
            }], onAddEntry: [{
                type: Output
            }], onPaginationChange: [{
                type: Output
            }], table: [{
                type: ViewChild,
                args: [MatTable, { static: true }]
            }], paginator: [{
                type: ViewChild,
                args: [MatPaginator]
            }], columnDefs: [{
                type: ContentChildren,
                args: [BaseColumn]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFibGUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LWxpYnVyZy9zcmMvbGliL3RhYmxlL3RhYmxlL3RhYmxlLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1saWJ1cmcvc3JjL2xpYi90YWJsZS90YWJsZS90YWJsZS5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsT0FBTyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBQyxNQUFNLHFCQUFxQixDQUFDO0FBQy9FLE9BQU8sRUFBYyxlQUFlLEVBQUMsTUFBTSx3QkFBd0IsQ0FBQztBQUNwRSxPQUFPLEVBQXFCLFdBQVcsRUFBQyxNQUFNLHFCQUFxQixDQUFDO0FBQ3BFLE9BQU8sRUFBbUMsU0FBUyxFQUFFLGVBQWUsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFhLE1BQU0sRUFBMEIsU0FBUyxFQUFFLGlCQUFpQixFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ3pMLE9BQU8sRUFBQyxZQUFZLEVBQVksTUFBTSw2QkFBNkIsQ0FBQztBQUNwRSxPQUFPLEVBQWUsUUFBUSxFQUFDLE1BQU0seUJBQXlCLENBQUM7QUFDL0QsT0FBTyxFQUFrQixPQUFPLEVBQUMsTUFBTSxNQUFNLENBQUM7QUFDOUMsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ3pDLE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQzs7Ozs7Ozs7QUFvQzFDLE1BQU0sT0FBTyxjQUFjO0lBZ0V6QixZQUNtQixrQkFBc0MsRUFDdEMsUUFBNkI7UUFEN0IsdUJBQWtCLEdBQWxCLGtCQUFrQixDQUFvQjtRQUN0QyxhQUFRLEdBQVIsUUFBUSxDQUFxQjtRQTVEekMsZUFBVSxHQUFhLEtBQUssQ0FBQztRQU1wQyxTQUFTO1FB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S0FBSyxDQUFDLEVBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsR0FBRyxFQUFDLENBQUMsQ0FBQzs0QkFDMUQsS0FBSyxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsRUFBQyxNQUFNLEVBQUUsR0FBRyxFQUFDLENBQUMsQ0FBQzs0QkFDdkMsVUFBVSxDQUNSLHdCQUF3QixFQUN4QixPQUFPLENBQUMsc0NBQXNDLENBQUMsQ0FDaEQ7eUJBQ0YsQ0FBQztxQkFDSCxpQkFDYyxpQkFBaUIsQ0FBQyxJQUFJO3lJQUt6QyxVQUFVO3NCQUZoQixLQUFLO2dCQUtDLFVBQVU7c0JBRGhCLEtBQUs7Z0JBS0MsVUFBVTtzQkFGaEIsS0FBSztnQkFNQyxVQUFVO3NCQURoQixLQUFLO2dCQUtDLGtCQUFrQjtzQkFEeEIsS0FBSztnQkFNQyxtQkFBbUI7c0JBRnpCLEtBQUs7Z0JBTUMsY0FBYztzQkFEcEIsS0FBSztnQkFNQyxnQkFBZ0I7c0JBRnRCLEtBQUs7Z0JBTUMsZUFBZTtzQkFGckIsS0FBSztnQkFLQyxhQUFhO3NCQURuQixLQUFLO2dCQUdXLFVBQVU7c0JBQTFCLE1BQU07Z0JBRVUsa0JBQWtCO3NCQUFsQyxNQUFNO2dCQU84QixLQUFLO3NCQUF6QyxTQUFTO3VCQUFDLFFBQVEsRUFBRSxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUM7Z0JBR1YsU0FBUztzQkFBakMsU0FBUzt1QkFBQyxZQUFZO2dCQUloQixVQUFVO3NCQUZoQixlQUFlO3VCQUFDLFVBQVUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2FuaW1hdGUsIHN0YXRlLCBzdHlsZSwgdHJhbnNpdGlvbiwgdHJpZ2dlcn0gZnJvbSAnQGFuZ3VsYXIvYW5pbWF0aW9ucyc7XG5pbXBvcnQge0Nka0RyYWdEcm9wLCBtb3ZlSXRlbUluQXJyYXl9IGZyb20gXCJAYW5ndWxhci9jZGsvZHJhZy1kcm9wXCI7XG5pbXBvcnQge0JyZWFrcG9pbnRPYnNlcnZlciwgQnJlYWtwb2ludHN9IGZyb20gJ0Bhbmd1bGFyL2Nkay9sYXlvdXQnO1xuaW1wb3J0IHtBZnRlclZpZXdJbml0LCBDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBDb250ZW50Q2hpbGRyZW4sIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uRGVzdHJveSwgT3V0cHV0LCBRdWVyeUxpc3QsIFRlbXBsYXRlUmVmLCBWaWV3Q2hpbGQsIFZpZXdFbmNhcHN1bGF0aW9ufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7TWF0UGFnaW5hdG9yLCBQYWdlRXZlbnR9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL3BhZ2luYXRvcic7XG5pbXBvcnQge01hdENvbHVtbkRlZiwgTWF0VGFibGV9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL3RhYmxlJztcbmltcG9ydCB7QmVoYXZpb3JTdWJqZWN0LCBTdWJqZWN0fSBmcm9tICdyeGpzJztcbmltcG9ydCB7dGFrZVVudGlsfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQge0Jhc2VDb2x1bW59IGZyb20gJy4uL2Jhc2UtY29sdW1uJztcblxuZXhwb3J0IGludGVyZmFjZSBJQWN0aW9uTWF0ZXJpYWxDb2x1bW4ge1xuICBpY29uQ2xhc3MgOiBzdHJpbmc7XG5cbiAgY2xhc3NDc3MgOiBzdHJpbmc7XG5cbiAgbWV0aG9kIDogKHJvdz8gOiBhbnkpID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGF0YVNvdXJjZU1hdGVyaWFsVGFibGU8VD4ge1xuICBtb2RlbCA6IFQ7XG5cbiAgZWRpdGFibGUgOiBib29sZWFuO1xuXG4gIGFjdGlvbnMgOiBJQWN0aW9uTWF0ZXJpYWxDb2x1bW5bXTtcblxuICBpZD8gOiBudW1iZXI7XG59XG5cbkBDb21wb25lbnQoe1xuICAgICAgICAgICAgIHNlbGVjdG9yICAgICA6ICdlbGl4LXRhYmxlJyxcbiAgICAgICAgICAgICB0ZW1wbGF0ZVVybCAgOiAnLi90YWJsZS5jb21wb25lbnQuaHRtbCcsXG4gICAgICAgICAgICAgc3R5bGVVcmxzICAgIDogWycuL3RhYmxlLmNvbXBvbmVudC5zY3NzJ10sXG4gICAgICAgICAgICAgYW5pbWF0aW9ucyAgIDogW1xuICAgICAgICAgICAgICAgdHJpZ2dlcignZGV0YWlsRXhwYW5kJywgW1xuICAgICAgICAgICAgICAgICBzdGF0ZSgnY29sbGFwc2VkJywgc3R5bGUoe2hlaWdodDogJzBweCcsIG1pbkhlaWdodDogJzAnfSkpLFxuICAgICAgICAgICAgICAgICBzdGF0ZSgnZXhwYW5kZWQnLCBzdHlsZSh7aGVpZ2h0OiAnKid9KSksXG4gICAgICAgICAgICAgICAgIHRyYW5zaXRpb24oXG4gICAgICAgICAgICAgICAgICAgJ2V4cGFuZGVkIDw9PiBjb2xsYXBzZWQnLFxuICAgICAgICAgICAgICAgICAgIGFuaW1hdGUoJzIyNW1zIGN1YmljLWJlemllcigwLjQsIDAuMCwgMC4yLCAxKScpLFxuICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgXSksXG4gICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxuICAgICAgICAgICB9KVxuZXhwb3J0IGNsYXNzIFRhYmxlQ29tcG9uZW50PFQ+IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcbiAgQElucHV0KClcbiAgLy8gQHRzLWlnbm9yZVxuICBwdWJsaWMgZGF0YVNvdXJjZSA6IEFycmF5PERhdGFTb3VyY2VNYXRlcmlhbFRhYmxlPFQ+PjtcblxuICBASW5wdXQoKVxuICBwdWJsaWMgZXh0ZW5zaWJsZSA6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBASW5wdXQoKVxuICAvLyBAdHMtaWdub3JlXG4gIHB1YmxpYyBleHRhbmRibGUkIDogQmVoYXZpb3JTdWJqZWN0PERhdGFTb3VyY2VNYXRlcmlhbFRhYmxlPFQ+IHwgbnVsbD47XG5cbiAgLy8gRm9vdGVyXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBmb290ZXJTaG93IDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIC8vIGNsYXNzIGZvciBmb290ZXJcbiAgQElucHV0KClcbiAgcHVibGljIGZvb3Rlck1lc3NhZ2VDbGFzcyA6IHN0cmluZyA9ICcnO1xuXG4gIC8vIG5ldyB0YWJsZSBpbiByb3dcbiAgQElucHV0KClcbiAgLy8gQHRzLWlnbm9yZVxuICBwdWJsaWMgbmV3RWxlbWVudEV4dGFuZGJsZSA6IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgLy8gZmxhZyBhYm91dCBpZiB3ZSB3YW50IHRvIHNob3cgcGFnaW5hdGlvblxuICBASW5wdXQoKVxuICBwdWJsaWMgc2hvd1BhZ2luYXRpb24gOiBib29sZWFuID0gZmFsc2U7XG5cbiAgLy8gbnVtYmVyT2YgRW50cnlcbiAgQElucHV0KClcbiAgLy8gQHRzLWlnbm9yZVxuICBwdWJsaWMgbGVuZ2h0UGFnaW5hdGlvbiA6IG51bWJlcjtcblxuICBASW5wdXQoKVxuICAvLyBAdHMtaWdub3JlXG4gIHB1YmxpYyBwYWdpbmF0aW9uQ2xhc3MgOiBzdHJpbmc7XG5cbiAgQElucHV0KClcbiAgcHVibGljIGFkZGVkTmV3RW50cnkgPSBmYWxzZTtcblxuICBAT3V0cHV0KCkgcHVibGljIG9uQWRkRW50cnkgOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIEBPdXRwdXQoKSBwdWJsaWMgb25QYWdpbmF0aW9uQ2hhbmdlIDogRXZlbnRFbWl0dGVyPFBhZ2VFdmVudD4gPVxuICAgICAgICAgICAgICAgICAgICAgbmV3IEV2ZW50RW1pdHRlcjxQYWdlRXZlbnQ+KCk7XG5cbiAgcHVibGljIGNvbHVtbnNUb0Rpc3BhbHkgOiBzdHJpbmdbXSA9IFtdO1xuXG4gIC8vIHRoaXMgaXMgd2hlcmUgdGhlIG1hZ2ljIGhhcHBlbnM6XG4gIC8vIEB0cy1pZ25vcmVcbiAgQFZpZXdDaGlsZChNYXRUYWJsZSwge3N0YXRpYzogdHJ1ZX0pIHRhYmxlIDogTWF0VGFibGU8VD47XG5cbiAgLy8gQHRzLWlnbm9yZVxuICBAVmlld0NoaWxkKE1hdFBhZ2luYXRvcikgcGFnaW5hdG9yIDogTWF0UGFnaW5hdG9yO1xuXG4gIEBDb250ZW50Q2hpbGRyZW4oQmFzZUNvbHVtbilcbiAgLy8gQHRzLWlnbm9yZVxuICBwdWJsaWMgY29sdW1uRGVmcyA6IFF1ZXJ5TGlzdDxCYXNlQ29sdW1uPjtcblxuICBwcml2YXRlIGRvdWJsZUNvbHVtblRvRGlzcGxheSA6IHN0cmluZ1tdID0gW107XG5cbiAgLy8gZm9yIGF2b2lkIG1lbW9yeSBsZWFrXG4gIHByaXZhdGUgX2Rlc3Ryb3llZCA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSByZWFkb25seSBfY2hhbmdlRGV0ZWN0b3JSZWYgOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9iclBvaW50IDogQnJlYWtwb2ludE9ic2VydmVyLFxuICApIHt9XG5cbiAgLy8gYWZ0ZXIgdGhlIDxuZy1jb250ZW50PiBoYXMgYmVlbiBpbml0aWFsaXplZCwgdGhlIGNvbHVtbiBkZWZpbml0aW9ucyBhcmUgYXZhaWxhYmxlLlxuICBwdWJsaWMgbmdBZnRlclZpZXdJbml0KCkgOiB2b2lkIHtcbiAgICB0aGlzLmNvbHVtbnNUb0Rpc3BhbHkgPSB0aGlzLmNvbHVtbkRlZnMubWFwKFxuICAgICAgKHJlc3AgOiBCYXNlQ29sdW1uKSA9PiByZXNwLmNvbHVtbkRlZi5uYW1lLFxuICAgICk7XG4gICAgdGhpcy5jb2x1bW5EZWZzXG4gICAgICAubWFwKChyZXNwIDogQmFzZUNvbHVtbikgPT4gcmVzcC5jb2x1bW5EZWYpXG4gICAgICAuZm9yRWFjaCgocmVwIDogTWF0Q29sdW1uRGVmKSA9PiB0aGlzLnRhYmxlLmFkZENvbHVtbkRlZihyZXApKTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZHVwbGljYXRlICAgICAgICAgICAgPSB0aGlzLmNvbHVtbnNUb0Rpc3BhbHkuZmlsdGVyKFxuICAgICAgICAoY29sdW1uRGlzcGxheSA6IHN0cmluZywgaW5kZXggOiBudW1iZXIsIHNlbGYgOiBzdHJpbmdbXSkgPT5cbiAgICAgICAgICBpbmRleCA9PT0gc2VsZi5maW5kSW5kZXgoKHZhbHVlIDogc3RyaW5nKSA9PiB2YWx1ZSA9PT0gY29sdW1uRGlzcGxheSksXG4gICAgICApO1xuICAgICAgdGhpcy5kb3VibGVDb2x1bW5Ub0Rpc3BsYXkgPSB0aGlzLmNvbHVtbnNUb0Rpc3BhbHk7XG4gICAgICB0aGlzLl9zZXRDb2x1bW5Gb3JMYXlvdXQoKTtcbiAgICAgIGlmKGR1cGxpY2F0ZS5sZW5ndGggPCB0aGlzLmNvbHVtbnNUb0Rpc3BhbHkubGVuZ3RoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAnWW91IGR1cGxpY2F0ZSB2YWx1ZSB3aGF0IHlvdSB3YW50IHRvIGRpc3BsYXksIFBsZWFzZSBsb29rIGluIGRlZmluaXRpb25zIGF0IGNvbHVtbnMnLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBjYXRjaChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9XG4gICAgdGhpcy5fY2hhbmdlRGV0ZWN0b3JSZWYuZGV0ZWN0Q2hhbmdlcygpO1xuICB9XG5cbiAgcHVibGljIGFkZE5ld0VudHJ5KCkge1xuICAgIHRoaXMub25BZGRFbnRyeS5uZXh0KCk7XG4gIH1cblxuICBwdWJsaWMgY2hhbmdlUGFnZShldmVudCA6IFBhZ2VFdmVudCkge1xuICAgIHRoaXMub25QYWdpbmF0aW9uQ2hhbmdlLmVtaXQoZXZlbnQpO1xuICB9XG5cbiAgcHVibGljIGRyb3AoZXZlbnQgOiBDZGtEcmFnRHJvcDxBcnJheTxEYXRhU291cmNlTWF0ZXJpYWxUYWJsZTxUPj4+KSA6IHZvaWQge1xuICAgIG1vdmVJdGVtSW5BcnJheSh0aGlzLmRhdGFTb3VyY2UsIGV2ZW50LnByZXZpb3VzSW5kZXgsIGV2ZW50LmN1cnJlbnRJbmRleCk7XG4gICAgdGhpcy50YWJsZS5yZW5kZXJSb3dzKCk7XG4gIH1cblxuICBwdWJsaWMgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5fZGVzdHJveWVkLm5leHQoKTtcbiAgICB0aGlzLl9kZXN0cm95ZWQuY29tcGxldGUoKTtcbiAgfVxuXG4gIHByaXZhdGUgX3NldENvbHVtbkZvckxheW91dCgpIHtcbiAgICB0aGlzLl9iclBvaW50XG4gICAgICAub2JzZXJ2ZShbXG4gICAgICAgICAgICAgICAgIEJyZWFrcG9pbnRzLlhTbWFsbCxcbiAgICAgICAgICAgICAgICAgQnJlYWtwb2ludHMuU21hbGwsXG4gICAgICAgICAgICAgICAgIEJyZWFrcG9pbnRzLk1lZGl1bSxcbiAgICAgICAgICAgICAgICAgQnJlYWtwb2ludHMuTGFyZ2UsXG4gICAgICAgICAgICAgICAgIEJyZWFrcG9pbnRzLlhMYXJnZSxcbiAgICAgICAgICAgICAgIF0pXG4gICAgICAucGlwZSh0YWtlVW50aWwodGhpcy5fZGVzdHJveWVkKSlcbiAgICAgIC5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICBpZih0aGlzLl9iclBvaW50LmlzTWF0Y2hlZChCcmVha3BvaW50cy5YU21hbGwpKSB7XG4gICAgICAgICAgdGhpcy5jb2x1bW5zVG9EaXNwYWx5ID0gdGhpcy5kb3VibGVDb2x1bW5Ub0Rpc3BsYXkuZmlsdGVyKFxuICAgICAgICAgICAgKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgaW5kZXggPD0gMCB8fCBpbmRleCA9PT0gdGhpcy5kb3VibGVDb2x1bW5Ub0Rpc3BsYXkubGVuZ3RoIC0gMVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYodGhpcy5fYnJQb2ludC5pc01hdGNoZWQoQnJlYWtwb2ludHMuU21hbGwpKSB7XG4gICAgICAgICAgdGhpcy5jb2x1bW5zVG9EaXNwYWx5ID0gdGhpcy5kb3VibGVDb2x1bW5Ub0Rpc3BsYXkuZmlsdGVyKFxuICAgICAgICAgICAgKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgaW5kZXggPD0gMiB8fCBpbmRleCA9PT0gdGhpcy5kb3VibGVDb2x1bW5Ub0Rpc3BsYXkubGVuZ3RoIC0gMVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYodGhpcy5fYnJQb2ludC5pc01hdGNoZWQoQnJlYWtwb2ludHMuTWVkaXVtKSkge1xuICAgICAgICAgIHRoaXMuY29sdW1uc1RvRGlzcGFseSA9IHRoaXMuZG91YmxlQ29sdW1uVG9EaXNwbGF5LmZpbHRlcihcbiAgICAgICAgICAgIChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIGluZGV4IDw9IDMgfHwgaW5kZXggPT09IHRoaXMuZG91YmxlQ29sdW1uVG9EaXNwbGF5Lmxlbmd0aCAtIDFcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHRoaXMuX2JyUG9pbnQuaXNNYXRjaGVkKEJyZWFrcG9pbnRzLkxhcmdlKSkge1xuICAgICAgICAgIHRoaXMuY29sdW1uc1RvRGlzcGFseSA9IHRoaXMuZG91YmxlQ29sdW1uVG9EaXNwbGF5LmZpbHRlcihcbiAgICAgICAgICAgIChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIGluZGV4IDw9IDQgfHwgaW5kZXggPT09IHRoaXMuZG91YmxlQ29sdW1uVG9EaXNwbGF5Lmxlbmd0aCAtIDFcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHRoaXMuX2JyUG9pbnQuaXNNYXRjaGVkKEJyZWFrcG9pbnRzLlhMYXJnZSkpIHtcbiAgICAgICAgICB0aGlzLmNvbHVtbnNUb0Rpc3BhbHkgPSB0aGlzLmRvdWJsZUNvbHVtblRvRGlzcGxheS5maWx0ZXIoXG4gICAgICAgICAgICAoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICBpbmRleCA+PSAwXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG59XG4iLCI8bWF0LXRhYmxlIG1hdC10YWJsZSBbZGF0YVNvdXJjZV09XCJkYXRhU291cmNlXCIgbXVsdGlUZW1wbGF0ZURhdGFSb3dzPVwidHJ1ZVwiIGNka0Ryb3BMaXN0IFtjZGtEcm9wTGlzdERhdGFdPVwiZGF0YVNvdXJjZVwiXG4gICAgICAgICAgIFtuZ1N0eWxlXT1cInsnYm94LXNoYWRvdyc6IGFkZGVkTmV3RW50cnkgPyAnbm9uZSc6ICcnfVwiXG4gICAgICAgICAgIChjZGtEcm9wTGlzdERyb3BwZWQpPVwiZHJvcCgkZXZlbnQpXCI+XG4gIDxuZy1jb250ZW50PjwvbmctY29udGVudD5cbiAgPG1hdC1oZWFkZXItcm93XG4gICAgY2xhc3M9XCJoZWFkZXItY29sb3IgZ2FwLTFcIlxuICAgIG1hdC1oZWFkZXItcm93XG4gICAgKm1hdEhlYWRlclJvd0RlZj1cImNvbHVtbnNUb0Rpc3BhbHk7IHN0aWNreTogdHJ1ZVwiXG4gID5cbiAgPC9tYXQtaGVhZGVyLXJvdz5cbiAgPG1hdC1yb3dcbiAgICBtYXQtcm93XG4gICAgY2RrRHJhZ1xuICAgICptYXRSb3dEZWY9XCJsZXQgcm93OyBjb2x1bW5zOiBjb2x1bW5zVG9EaXNwYWx5XCJcbiAgICBjbGFzcz1cImdhcC0xIGhlYWRlci1ib3JkZXItbGVmdFwiXG4gID48L21hdC1yb3c+XG4gIDwhLS0gRm9vdGVyIGZvciB0YWJlbCAtLT5cbiAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImZvb3RlclNob3dcIj5cbiAgICA8bWF0LWZvb3Rlci1yb3dcbiAgICAgIFtjbGFzc109XCJmb290ZXJNZXNzYWdlQ2xhc3NcIlxuICAgICAgKm1hdEZvb3RlclJvd0RlZj1cImNvbHVtbnNUb0Rpc3BhbHlcIlxuICAgICAgW2F0dHIuY29sc3Bhbl09XCJjb2x1bW5zVG9EaXNwYWx5Lmxlbmd0aFwiXG4gICAgPlxuICAgIDwvbWF0LWZvb3Rlci1yb3c+XG4gIDwvbmctY29udGFpbmVyPlxuXG4gIDwhLS0gIEV4dGFuYmxlLS0+XG4gIDxuZy1jb250YWluZXIgKm5nSWY9XCJleHRlbnNpYmxlXCI+XG4gICAgPG5nLWNvbnRhaW5lciBtYXRDb2x1bW5EZWY9XCJleHRlbnNpYmxlRGF0YVwiPlxuICAgICAgPG1hdC1jZWxsXG4gICAgICAgICptYXRDZWxsRGVmPVwibGV0IGVsZW1lbnRcIlxuICAgICAgICBbYXR0ci5jb2xzcGFuXT1cImNvbHVtbnNUb0Rpc3BhbHkubGVuZ3RoXCJcbiAgICAgICAgY2xhc3M9XCJvdmVyZmxvdy1oaWRkZW5cIlxuICAgICAgPlxuICAgICAgICA8ZGl2XG4gICAgICAgICAgW0BkZXRhaWxFeHBhbmRdPVwiXG4gICAgICAgICAgICBlbGVtZW50ID09PSAoZXh0YW5kYmxlJCB8IGFzeW5jKSA/ICdleHBhbmRlZCcgOiAnY29sbGFwc2VkJ1xuICAgICAgICAgIFwiXG4gICAgICAgICAgY2xhc3M9XCJlbGl4X190YWJsZVwiXG4gICAgICAgID5cbiAgICAgICAgICA8bmctY29udGFpbmVyXG4gICAgICAgICAgICAqbmdUZW1wbGF0ZU91dGxldD1cIlxuICAgICAgICAgICAgICBuZXdFbGVtZW50RXh0YW5kYmxlO1xuICAgICAgICAgICAgICBjb250ZXh0OiB7ICRpbXBsaWNpdDogZWxlbWVudCB9XG4gICAgICAgICAgICBcIlxuICAgICAgICAgID5cbiAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L21hdC1jZWxsPlxuICAgIDwvbmctY29udGFpbmVyPlxuXG4gICAgPG1hdC1yb3dcbiAgICAgICptYXRSb3dEZWY9XCJsZXQgcm93OyBjb2x1bW5zOiBbJ2V4dGVuc2libGVEYXRhJ11cIlxuICAgICAgY2xhc3M9XCJleGFtcGxlLWRldGFpbC1yb3cgZ2FwLTEgaGVhZGVyLWJvcmRlci1sZWZ0XCJcbiAgICA+PC9tYXQtcm93PlxuICA8L25nLWNvbnRhaW5lcj5cbjwvbWF0LXRhYmxlPlxuPGRpdiBjbGFzcz1cIm5ld1wiICpuZ0lmPVwiYWRkZWROZXdFbnRyeVwiIChjbGljayk9XCJhZGROZXdFbnRyeSgpXCI+XG4gIDxtYXQtaWNvblxuICAgIFtzdmdJY29uXT1cIidmYV9zb2xpZDpjaXJjbGUtcGx1cydcIlxuICAgIGNsYXNzPVwibmV3LWVudHJ5XCJcbiAgPjwvbWF0LWljb24+XG4gIDxkaXY+XG4gICAgPHA+QWRkZWQgbmV3IEVudHJ5PC9wPlxuICA8L2Rpdj5cblxuPC9kaXY+XG48bWF0LXBhZ2luYXRvclxuICBbY2xhc3NdPVwicGFnaW5hdGlvbkNsYXNzXCJcbiAgKm5nSWY9XCJzaG93UGFnaW5hdGlvblwiXG4gIChwYWdlKT1cImNoYW5nZVBhZ2UoJGV2ZW50KVwiXG4gIFtsZW5ndGhdPVwibGVuZ2h0UGFnaW5hdGlvblwiXG4gIFtwYWdlU2l6ZU9wdGlvbnNdPVwiWzEwLCAyMCwgNTBdXCJcbiAgc2hvd0ZpcnN0TGFzdEJ1dHRvbnNcbiAgYXJpYS1sYWJlbD1cIlNlbGVjdCBwYWdlIG9mIHBlcmlvZGljIGVsZW1lbnRzXCJcbj5cbjwvbWF0LXBhZ2luYXRvcj5cbiJdfQ==